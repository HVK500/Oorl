"use strict";!function(t){function e(t,u){return this instanceof e==0?new e(t,u):(this.Name=t,this.Count=u,this.getJson=function(){return{metricType:n.Count,name:this.Name,value:this.Count}},this)}var n={Unknown:0,Count:1};t.Metrics=t.Metrics||{},t.Metrics.Client=function t(n,u,i){if(this instanceof t==0)return new t(n,u,i);var s={},o={getPayload:function(){var t=[];return s.Buffer.forEach(function(e){t.push(e.getJson())}),s.Buffer=[],t},startPumpTimeout:function(){null===s.FlushTimeout&&(s.FlushTimeout=setTimeout(s.FlushFn,1e3*s.FlushIntervalSec))},post:function(t,e,n,u){var i=new XMLHttpRequest;i.open("POST",t),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(e)),i.onreadystatechange=function(){4===this.readyState&&(200===this.status?"function"==typeof n&&n(this):"function"==typeof u&&u(this))}}};return s.ServerEndpoint=n,s.MetricNamespace=u,s.FlushIntervalSec=i,s.FlushTimeout=null,s.Buffer=[],s.FlushFn=function(){if(s.FlushTimeout=null,s.Buffer.length>0){var t=s.ServerEndpoint+"API/Publish/Metrics",e={Metrics:o.getPayload()};o.post(t,e,o.startPumpTimeout,o.startPumpTimeout)}else o.startPumpTimeout()},s.LogCount=function(t,n){var u=new e(this.MetricNamespace+"."+t,n);s.Buffer.push(u)},s.FlushTimeout=setTimeout(s.FlushFn,1e3*s.FlushIntervalSec),s},t.Metrics.CountMetric=e}(window);